
Notes on Battery Testing

Mock battery settings are available for testing purposes.

The indicator's schema name is "com.canonical.indicator.power" and there are four keys: "mock-battery-enabled" (a boolean), "mock-battery-level" (charger percent, an integer from 0-100),  "mock-battery-charging" (a boolean of whether the mock battery is charging or discharging), and "mock-battery-minutes-left" (minutes remaining to charge/discharge).

Example use:

$ gsettings reset-recursively com.canonical.indicator.power               # reset settings to the default state
$ gsettings list-recursively com.canonical.indicator.power | grep mock    # show the current mock settings
$ gsettings set com.canonical.indicator.power mock-battery-enabled true   # use the mock battery
$ gsettings set com.canonical.indicator.power mock-battery-level 10       # set the mock battery's charge to 10%
$ gsettings set com.canonical.indicator.power mock-battery-enabled false  # go back to production settings


Test-case indicator-power/unity7-items-check
<dl>
    <dt>Log in to a Unity 7 user session</dt>
    <dt>Go to the panel and click on the Power indicator</dt>
        <dd>Ensure there are items in the menu</dd>
</dl>

Test-case indicator-power/unity7-greeter-items-check
<dl>
    <dt>Start a system and wait for the greeter or logout of the current user session</dt>
    <dt>Go to the panel and click on the Power indicator</dt>
        <dd>Ensure there are items in the menu</dd>
</dl>

Test-case indicator-power/unity8-items-check
<dl>
    <dt>Login to a user session running Unity 8</dt>
    <dt>Pull down the top panel until it sticks open</dt>
    <dt>Navigate through the tabs until "Battery" is shown</dt>
        <dd>Battery is at the top of the menu</dd>
        <dd>The menu is populated with items</dd>
</dl>

Test-case indicator-power/detect-charging-or-discharging
<dl>
    <dt>Begin with a discharging device</dt>
        <dd>The indicator's icon should denote a discharging battery; e.g. an icon without the 'âš¡' sign</dd>
    <dt>Plug it in so that its battery is charging</dt>
        <dd>The indicator's icon should change to show a charging battery</dd> 
    <dt>Unplug it again</dt>
        <dd>The indicator's icon should revert back to the same one in step one</dd>
</dl>

Test-case indicator-power/low-power-notifications
<dl>
    <dt>Wait for the system's battery level to drop to 10% (or fake it, see 'Notes on Battery Testing' above)</dt>
        <dd>A notification should appear</dd>
        <dd>Its title should read "Battery Low"</dd>
        <dd>Its text should read "10% charge remaining"</dd>
        <dd>The icon should be a low power icon</dd>
        <dd>It should have two actions, "Battery settings" and "OK". </dd>
    <dt>Tap OK to dismiss the popup</dt>
    <dt>Wait (or fake) the battery level to drop to 9%</dt>
        <dd>No new notification should appear -- we're still at the "Low" level </dd>
    <dt>Wait (or fake) the battery level to drop to 4%</dt>
        <dd>A notification should appear</dd>
        <dd>Its title should read "Battery Critical"</dd>
        <dd>Its text should read "4% charge remaining"</dd>
        <dd>The icon should be a critical power icon</dd>
        <dd>It should have two actions, "Battery settings" and "OK". </dd>
    <dt>Tap 'Battery Settings'</dt>
        <dd>ubuntu-system-settings should be launched to the Battery page </dd>
</dl>

Test-case indicator-power/device-brightness-slider
<dl>
    <dt>On a device, pull down the power indicator's menu</dt>
        <dd>The menu should include a brightness slider with icons</dd>
    <dt>Slide the brightness slider back and forth</dt>
        <dd>The screen should get brighter and darker in sync with the slider's position</dd>
    <dt>Launch unity-system-settings' Brightness panel</dt>
    <dt>Move both the indicator's and the settings panel's sliders</dt>
        <dd>Both sliders' positions should stay in sync with each other</dd>
        <dd>Both should have the same effect on the screen's brightness</dd>
    <dt>Make a note of the current brightness level and slider position</dt>
    <dt>Reboot the device</dt>
        <dd>The screen brightness should be the same as it was before rebooting</dd>
        <dd>The indicator's brightness slider should be in the same position as it was before rebooting</dd>
</dl>
